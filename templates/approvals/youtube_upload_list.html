{% extends 'base_sidebar.html' %} 
{% block title %}{{ title }} - CreatorFlow{% endblock %} 
{% block content %}
<div id="view-youtube-uploads" class="view-section">
  <div class="row">
    <div class="col-12">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>{{ title }}</h2>
        <div style="margin-top: 10px">
          <a
            href="{% url 'approvals:request_history' %}"
            class="btn btn-outline-primary"
          >
            <i class="bi bi-clock-history"></i> Request History
          </a>
          <a
            href="{% url 'approvals:request_list' %}"
            class="btn btn-outline-secondary"
          >
            View All Requests
          </a>
        </div>
      </div>

      {% if not youtube_connected %}
      <div class="alert alert-warning">
        <h5>
          <i class="bi bi-exclamation-triangle"></i> YouTube Not Connected
        </h5>
        <p>
          You need to connect your YouTube channel before you can upload videos.
        </p>
        <a href="{% url 'integrations:dashboard' %}" class="btn btn-warning"
          >Connect YouTube Channel</a
        >
      </div>
      {% endif %} {% if requests %}
      <div class="alert alert-info mb-4">
        <strong>{{ requests|length }}</strong> approved video{{
        requests|length|pluralize }} ready for upload.
      </div>

      <div class="row" style="margin-top: 10px">
        {% for request in requests %}
        <div class="col-md-6 mb-4">
          <div class="card h-100">
            <div class="card-header bg-success text-white">
              <h5 class="mb-0"><i class="bi bi-check-circle"></i> Approved</h5>
            </div>
            <div class="card-body">
              <h6 class="card-title">{{ request.file.name }}</h6>

              <div class="mb-3">
                <small class="text-muted">
                  <strong>Submitted by:</strong> {{ request.editor.username
                  }}<br />
                  <strong>Approved by:</strong> {{ request.reviewed_by.username
                  }}<br />
                  <strong>Approved on:</strong> {{
                  request.reviewed_at|date:"Y-m-d H:i" }}<br />
                  <strong>File size:</strong> {{ request.file.get_size_display
                  }}<br />
                  <strong>File type:</strong> {{ request.file.mime_type }}
                </small>
              </div>

              {% if request.description %}
              <div class="mb-3">
                <strong>Description:</strong>
                <p class="text-muted mb-0">
                  {{ request.description|truncatewords:30 }}
                </p>
              </div>
              {% else %}
              <div class="mb-3">
                <em class="text-muted">No description provided</em>
              </div>
              {% endif %}
            </div>
            <div class="card-footer">
              {% if youtube_connected %}
              <a
                href="{% url 'approvals:youtube_upload' request.pk %}"
                class="btn btn-danger w-100"
              >
                <i class="bi bi-youtube"></i> Upload to YouTube
              </a>
              {% else %}
              <button class="btn btn-secondary w-100" disabled>
                <i class="bi bi-youtube"></i> Connect YouTube First
              </button>
              {% endif %}
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
      {% else %}
      <div class="alert alert-info" style="margin-top: 10px">
        <h5 style="margin-top: 10px">No Videos Ready for Upload</h5>
        <p>
          There are no approved videos waiting to be uploaded to YouTube at this
          time.
        </p>
        <a
          href="{% url 'approvals:pending_approvals' %}"
          class="btn btn-primary"
          style="margin-top: 10px"
          >Review Pending Approvals</a
        >
      </div>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}
