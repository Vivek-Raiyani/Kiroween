<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Toast Notification Test</title>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Oswald:wght@500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="static/css/sidebar-redesign.css">
    
    <style>
        body {
            padding: 50px;
            font-family: var(--font-body);
        }
        
        .test-container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            background: white;
            border: 2px solid var(--ink);
            border-radius: 12px;
        }
        
        .test-section h2 {
            margin-bottom: 15px;
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .test-results {
            margin-top: 20px;
            padding: 15px;
            background: var(--gray-100);
            border-radius: 8px;
            font-family: monospace;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <!-- Toast Container -->
    <div class="toast-container"></div>
    
    <div class="test-container">
        <h1>Toast Notification System Test</h1>
        
        <!-- Test 1: Basic Toast Types -->
        <div class="test-section">
            <h2>Test 1: Toast Types</h2>
            <p>Click each button to test different toast types:</p>
            <div class="button-group">
                <button class="btn btn-green" onclick="testToast('success')">
                    <i class="fas fa-check"></i> Success Toast
                </button>
                <button class="btn btn-red" onclick="testToast('error')">
                    <i class="fas fa-times"></i> Error Toast
                </button>
                <button class="btn btn-purple" onclick="testToast('warning')">
                    <i class="fas fa-exclamation-triangle"></i> Warning Toast
                </button>
                <button class="btn btn-blue" onclick="testToast('info')">
                    <i class="fas fa-info-circle"></i> Info Toast
                </button>
            </div>
        </div>
        
        <!-- Test 2: Auto-Dismiss -->
        <div class="test-section">
            <h2>Test 2: Auto-Dismiss (5 seconds)</h2>
            <p>This toast should automatically disappear after 5 seconds:</p>
            <button class="btn btn-primary" onclick="testAutoDismiss()">
                <i class="fas fa-clock"></i> Test Auto-Dismiss
            </button>
            <div id="autoDismissResult" class="test-results" style="display: none;"></div>
        </div>
        
        <!-- Test 3: Manual Close -->
        <div class="test-section">
            <h2>Test 3: Manual Close</h2>
            <p>Click the X button to manually close the toast:</p>
            <button class="btn btn-primary" onclick="testManualClose()">
                <i class="fas fa-hand-pointer"></i> Test Manual Close
            </button>
        </div>
        
        <!-- Test 4: Toast Stacking (5 limit) -->
        <div class="test-section">
            <h2>Test 4: Toast Stacking (Max 5)</h2>
            <p>Create multiple toasts. Only 5 should be visible at once:</p>
            <button class="btn btn-primary" onclick="testStacking()">
                <i class="fas fa-layer-group"></i> Create 7 Toasts
            </button>
        </div>
        
        <!-- Test 5: Django Messages Integration -->
        <div class="test-section">
            <h2>Test 5: Django Messages Integration</h2>
            <p>Simulate Django messages being converted to toasts:</p>
            <button class="btn btn-primary" onclick="testDjangoMessages()">
                <i class="fab fa-python"></i> Test Django Messages
            </button>
        </div>
        
        <!-- Test 6: Long Messages -->
        <div class="test-section">
            <h2>Test 6: Long Messages</h2>
            <p>Test toast with a very long message:</p>
            <button class="btn btn-primary" onclick="testLongMessage()">
                <i class="fas fa-align-left"></i> Test Long Message
            </button>
        </div>
    </div>
    
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    
    <!-- Main JS -->
    <script src="static/js/main.js"></script>
    
    <script>
        // Test Functions
        
        function testToast(type) {
            const messages = {
                success: 'Operation completed successfully!',
                error: 'An error occurred. Please try again.',
                warning: 'Warning: This action cannot be undone.',
                info: 'Here is some helpful information.'
            };
            
            showToast(messages[type], type);
        }
        
        function testAutoDismiss() {
            const startTime = Date.now();
            const $result = $('#autoDismissResult');
            
            $result.show().html('Toast created at: ' + new Date().toLocaleTimeString() + '<br>Waiting for auto-dismiss...');
            
            showToast('This toast will auto-dismiss in 5 seconds', 'info');
            
            // Check if toast is dismissed after 5 seconds
            setTimeout(() => {
                const elapsed = Date.now() - startTime;
                const toastCount = $('.toast').length;
                
                $result.html(
                    'Toast created at: ' + new Date(startTime).toLocaleTimeString() + '<br>' +
                    'Checked at: ' + new Date().toLocaleTimeString() + '<br>' +
                    'Elapsed time: ' + (elapsed / 1000).toFixed(2) + ' seconds<br>' +
                    'Toasts remaining: ' + toastCount + '<br>' +
                    'Status: ' + (toastCount === 0 ? '✅ PASSED - Toast auto-dismissed' : '❌ FAILED - Toast still visible')
                );
            }, 5500);
        }
        
        function testManualClose() {
            showToast('Click the X button to close this toast manually', 'info');
        }
        
        function testStacking() {
            for (let i = 1; i <= 7; i++) {
                setTimeout(() => {
                    showToast(`Toast #${i} - Only 5 should be visible at once`, 'info');
                }, i * 200);
            }
            
            setTimeout(() => {
                const toastCount = $('.toast').length;
                alert(`Current toast count: ${toastCount}\nExpected: 5 or less\nResult: ${toastCount <= 5 ? '✅ PASSED' : '❌ FAILED'}`);
            }, 2000);
        }
        
        function testDjangoMessages() {
            // Simulate Django messages HTML
            const djangoMessagesHTML = `
                <div class="django-messages" style="display: none;">
                    <div class="message" data-level="success">Your profile has been updated successfully!</div>
                    <div class="message" data-level="error">Failed to upload file. File size exceeds limit.</div>
                    <div class="message" data-level="warning">Your session will expire in 5 minutes.</div>
                    <div class="message" data-level="info">New features are now available. Check them out!</div>
                </div>
            `;
            
            // Add to page
            $('body').append(djangoMessagesHTML);
            
            // Convert to toasts
            convertDjangoMessagesToToasts();
        }
        
        function testLongMessage() {
            const longMessage = 'This is a very long message that tests how the toast notification system handles lengthy content. It should wrap properly and maintain readability while staying within the maximum width constraints defined in the CSS. The toast should still look good and be easy to read even with all this text.';
            showToast(longMessage, 'info');
        }
        
        // Initialize on page load
        $(document).ready(function() {
            console.log('Toast notification test page loaded');
            console.log('showToast function available:', typeof showToast === 'function');
            console.log('convertDjangoMessagesToToasts function available:', typeof convertDjangoMessagesToToasts === 'function');
        });
    </script>
</body>
</html>
